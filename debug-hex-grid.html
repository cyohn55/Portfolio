<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hex Grid Debug Tool</title>
    <style>
        body { 
            font-family: monospace; 
            background: #222; 
            color: #0f0; 
            padding: 20px; 
        }
        .debug-section { 
            margin: 20px 0; 
            padding: 15px; 
            border: 1px solid #444; 
            background: #111; 
        }
        .success { color: #0f0; }
        .error { color: #f00; }
        .warning { color: #ff0; }
        #hex-grid { 
            border: 2px solid #0f0; 
            width: 800px; 
            height: 600px; 
            position: relative; 
            background: #000;
            margin: 20px 0;
        }
        button {
            background: #0f0;
            color: #000;
            border: none;
            padding: 10px 20px;
            margin: 10px;
            cursor: pointer;
            font-family: monospace;
            font-weight: bold;
        }
        button:hover { background: #0a0; }
        .tile-3d-container {
            border: 1px solid #0f0;
            background: rgba(0, 255, 0, 0.1);
        }
    </style>
</head>
<body>
    <h1>üî¨ Hex Grid Diagnostic Tool</h1>
    
    <div class="debug-section">
        <h2>üìã System Status</h2>
        <div id="systemStatus"></div>
    </div>

    <div class="debug-section">
        <h2>üéÆ Test Controls</h2>
        <button onclick="testHexCoordinates()">Test Hex Coordinates</button>
        <button onclick="testTerrainSystem()">Test Terrain System</button>
        <button onclick="testHexGeneration()">Generate Hex Grid</button>
        <button onclick="clearHexGrid()">Clear Grid</button>
    </div>

    <div class="debug-section">
        <h2>üó∫Ô∏è Hex Grid Container</h2>
        <div id="hex-grid"></div>
    </div>

    <div class="debug-section">
        <h2>üìä Debug Output</h2>
        <div id="debugOutput"></div>
    </div>

    <!-- Include your hex system scripts -->
    <script src="js/hex-coordinate.js"></script>
    <script src="js/game-config.js"></script>
    <script src="js/terrain-system.js"></script>

    <script>
        const debugOutput = document.getElementById('debugOutput');
        const systemStatus = document.getElementById('systemStatus');

        function log(message, type = 'info') {
            const div = document.createElement('div');
            div.className = type;
            div.textContent = `[${new Date().toISOString().split('T')[1].split('.')[0]}] ${message}`;
            debugOutput.appendChild(div);
            console.log(message);
            
            // Auto-scroll to bottom
            debugOutput.scrollTop = debugOutput.scrollHeight;
        }

        function checkSystemStatus() {
            let status = '';
            
            // Check if core classes exist
            status += `HexCoord: ${typeof HexCoord !== 'undefined' ? '‚úÖ' : '‚ùå'}\n`;
            status += `HexMath: ${typeof HexMath !== 'undefined' ? '‚úÖ' : '‚ùå'}\n`;
            status += `TerrainSystem: ${typeof TerrainSystem !== 'undefined' ? '‚úÖ' : '‚ùå'}\n`;
            status += `TERRAIN_CONFIG: ${typeof window.TERRAIN_CONFIG !== 'undefined' ? '‚úÖ' : '‚ùå'}\n`;
            status += `terrainSystem instance: ${typeof window.terrainSystem !== 'undefined' ? '‚úÖ' : '‚ùå'}\n`;
            
            // Check hex-grid container
            const container = document.getElementById('hex-grid');
            status += `hex-grid container: ${container ? '‚úÖ' : '‚ùå'}\n`;
            
            systemStatus.innerHTML = `<pre>${status}</pre>`;
        }

        function testHexCoordinates() {
            log('üß™ Testing Hex Coordinate System...', 'warning');
            
            try {
                const coord1 = new HexCoord(0, 0);
                const coord2 = new HexCoord(1, 0);
                const distance = coord1.distanceTo(coord2);
                
                log(`Hex distance (0,0) to (1,0): ${distance}`, distance === 1 ? 'success' : 'error');
                
                const neighbors = coord1.getNeighbors();
                log(`Hex neighbors count: ${neighbors.length}`, neighbors.length === 6 ? 'success' : 'error');
                
                log('‚úÖ Hex coordinates test complete', 'success');
            } catch (error) {
                log(`‚ùå Hex coordinates error: ${error.message}`, 'error');
            }
        }

        function testTerrainSystem() {
            log('üåç Testing Terrain System...', 'warning');
            
            try {
                if (!window.terrainSystem) {
                    window.terrainSystem = new TerrainSystem();
                    log('Created new terrain system instance', 'success');
                }
                
                // Test terrain types
                const terrainTypes = Object.keys(window.terrainSystem.terrainTypes);
                log(`Available terrain types: ${terrainTypes.join(', ')}`, 'success');
                
                // Test hex map generation
                const hexMap = window.terrainSystem.generateHexMap(3);
                log(`Generated hex map with ${hexMap.size} tiles`, hexMap.size > 0 ? 'success' : 'error');
                
                log('‚úÖ Terrain system test complete', 'success');
            } catch (error) {
                log(`‚ùå Terrain system error: ${error.message}`, 'error');
                console.error('Terrain system error details:', error);
            }
        }

        function testHexGeneration() {
            log('üèóÔ∏è Testing Visual Hex Grid Generation...', 'warning');
            
            try {
                if (!window.terrainSystem) {
                    window.terrainSystem = new TerrainSystem();
                }
                
                // Test visual hex grid generation
                const result = window.terrainSystem.generateHexGrid(6, 4, true);
                log(`Visual hex grid generation result: ${result}`, result ? 'success' : 'error');
                
                // Check container contents
                const container = document.getElementById('hex-grid');
                log(`Container children count: ${container.children.length}`, container.children.length > 0 ? 'success' : 'warning');
                
                if (container.children.length === 0) {
                    log('No tiles generated - checking for errors...', 'warning');
                    log('Try checking browser console for detailed error messages', 'warning');
                }
                
                log('‚úÖ Hex generation test complete', 'success');
            } catch (error) {
                log(`‚ùå Hex generation error: ${error.message}`, 'error');
                console.error('Hex generation error details:', error);
            }
        }

        function clearHexGrid() {
            const container = document.getElementById('hex-grid');
            container.innerHTML = '';
            log('üßπ Hex grid cleared', 'success');
        }

        // Initialize diagnostics
        document.addEventListener('DOMContentLoaded', () => {
            log('üî¨ Hex Grid Diagnostic Tool Loaded', 'success');
            checkSystemStatus();
            
            // Initialize enhanced systems if available
            if (typeof window.initializeEnhancedSystems === 'function') {
                try {
                    window.initializeEnhancedSystems();
                    log('Enhanced systems initialized', 'success');
                } catch (error) {
                    log(`Enhanced systems error: ${error.message}`, 'error');
                }
            }
            
            checkSystemStatus(); // Update status after initialization
        });
    </script>
</body>
</html>
